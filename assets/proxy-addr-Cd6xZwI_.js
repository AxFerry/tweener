import{f as w}from"./forwarded-Bh9yvCL8.js";import{i as k}from"./ipaddr.js-PhWhokjb.js";var f={exports:{}};/*!
 * proxy-addr
 * Copyright(c) 2014-2016 Douglas Christopher Wilson
 * MIT Licensed
 */f.exports=M;f.exports.all=h;f.exports.compile=m;var x=w,g=k,A=/^[0-9]+$/,d=g.isValid,u=g.parse,c={linklocal:["169.254.0.0/16","fe80::/10"],loopback:["127.0.0.1/8","::1/128"],uniquelocal:["10.0.0.0/8","172.16.0.0/12","192.168.0.0/16","fc00::/7"]};function h(r,e){var n=x(r);if(!e)return n;typeof e!="function"&&(e=m(e));for(var t=0;t<n.length-1;t++)e(n[t],t)||(n.length=t+1);return n}function m(r){if(!r)throw new TypeError("argument is required");var e;if(typeof r=="string")e=[r];else if(Array.isArray(r))e=r.slice();else throw new TypeError("unsupported trust argument");for(var n=0;n<e.length;n++)r=e[n],Object.prototype.hasOwnProperty.call(c,r)&&(r=c[r],e.splice.apply(e,[n,1].concat(r)),n+=r.length-1);return P(I(e))}function I(r){for(var e=new Array(r.length),n=0;n<r.length;n++)e[n]=E(r[n]);return e}function P(r){var e=r.length;return e===0?q:e===1?b(r[0]):N(r)}function E(r){var e=r.lastIndexOf("/"),n=e!==-1?r.substring(0,e):r;if(!d(n))throw new TypeError("invalid IP address: "+n);var t=u(n);e===-1&&t.kind()==="ipv6"&&t.isIPv4MappedAddress()&&(t=t.toIPv4Address());var s=t.kind()==="ipv6"?128:32,i=e!==-1?r.substring(e+1,r.length):null;if(i===null?i=s:A.test(i)?i=parseInt(i,10):t.kind()==="ipv4"&&d(i)?i=T(i):i=null,i<=0||i>s)throw new TypeError("invalid range on address: "+r);return[t,i]}function T(r){var e=u(r),n=e.kind();return n==="ipv4"?e.prefixLengthFromSubnetMask():null}function M(r,e){if(!r)throw new TypeError("req argument is required");if(!e)throw new TypeError("trust argument is required");var n=h(r,e),t=n[n.length-1];return t}function q(){return!1}function N(r){return function(n){if(!d(n))return!1;for(var t=u(n),s,i=t.kind(),o=0;o<r.length;o++){var a=r[o],p=a[0],v=p.kind(),y=a[1],l=t;if(i!==v){if(v==="ipv4"&&!t.isIPv4MappedAddress())continue;s||(s=v==="ipv4"?t.toIPv4Address():t.toIPv4MappedAddress()),l=s}if(l.match(p,y))return!0}return!1}}function b(r){var e=r[0],n=e.kind(),t=n==="ipv4",s=r[1];return function(o){if(!d(o))return!1;var a=u(o),p=a.kind();if(p!==n){if(t&&!a.isIPv4MappedAddress())return!1;a=t?a.toIPv4Address():a.toIPv4MappedAddress()}return a.match(e,s)}}var R=f.exports;export{R as p};
