import{h as Q}from"./http-errors-DNGOsyiD.js";import{b as V}from"./depd-x3Zs8R4U.js";import{d as ee}from"./destroy-jg19Iw-B.js";import{e as te}from"./escape-html-Ctoi4tIA.js";import{e as re}from"./etag-DrPXQ6z0.js";import{f as ne}from"./fresh-C7TtD2-c.js";import{r as T}from"./body-parser-ClE_Zh4T.js";import{m as ie}from"./mime-B2NofGGC.js";import{m as oe}from"./ms-DjyVKSdX.js";import{o as ae}from"./on-finished-rdFJ_shf.js";import{r as se}from"./range-parser-BtrMxpva.js";import{s as de}from"./statuses-PShsQ8FC.js";var B={exports:{}},D={exports:{}},L={exports:{}},v=1e3,y=v*60,_=y*60,b=_*24,fe=b*365.25,ue=function(r,e){e=e||{};var n=typeof r;if(n==="string"&&r.length>0)return ce(r);if(n==="number"&&isNaN(r)===!1)return e.long?le(r):he(r);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(r))};function ce(r){if(r=String(r),!(r.length>100)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(r);if(e){var n=parseFloat(e[1]),t=(e[2]||"ms").toLowerCase();switch(t){case"years":case"year":case"yrs":case"yr":case"y":return n*fe;case"days":case"day":case"d":return n*b;case"hours":case"hour":case"hrs":case"hr":case"h":return n*_;case"minutes":case"minute":case"mins":case"min":case"m":return n*y;case"seconds":case"second":case"secs":case"sec":case"s":return n*v;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}function he(r){return r>=b?Math.round(r/b)+"d":r>=_?Math.round(r/_)+"h":r>=y?Math.round(r/y)+"m":r>=v?Math.round(r/v)+"s":r+"ms"}function le(r){return F(r,b,"day")||F(r,_,"hour")||F(r,y,"minute")||F(r,v,"second")||r+" ms"}function F(r,e,n){if(!(r<e))return r<e*1.5?Math.floor(r/e)+" "+n:Math.ceil(r/e)+" "+n+"s"}(function(r,e){e=r.exports=i.debug=i.default=i,e.coerce=u,e.disable=d,e.enable=s,e.enabled=c,e.humanize=ue,e.names=[],e.skips=[],e.formatters={};var n;function t(o){var a=0,l;for(l in o)a=(a<<5)-a+o.charCodeAt(l),a|=0;return e.colors[Math.abs(a)%e.colors.length]}function i(o){function a(){if(a.enabled){var l=a,m=+new Date,E=m-(n||m);l.diff=E,l.prev=n,l.curr=m,n=m;for(var g=new Array(arguments.length),x=0;x<g.length;x++)g[x]=arguments[x];g[0]=e.coerce(g[0]),typeof g[0]!="string"&&g.unshift("%O");var H=0;g[0]=g[0].replace(/%([a-zA-Z%])/g,function(w,Z){if(w==="%%")return w;H++;var P=e.formatters[Z];if(typeof P=="function"){var K=g[H];w=P.call(l,K),g.splice(H,1),H--}return w}),e.formatArgs.call(l,g);var Y=a.log||e.log||console.log.bind(console);Y.apply(l,g)}}return a.namespace=o,a.enabled=e.enabled(o),a.useColors=e.useColors(),a.color=t(o),typeof e.init=="function"&&e.init(a),a}function s(o){e.save(o),e.names=[],e.skips=[];for(var a=(typeof o=="string"?o:"").split(/[\s,]+/),l=a.length,m=0;m<l;m++)a[m]&&(o=a[m].replace(/\*/g,".*?"),o[0]==="-"?e.skips.push(new RegExp("^"+o.substr(1)+"$")):e.names.push(new RegExp("^"+o+"$")))}function d(){e.enable("")}function c(o){var a,l;for(a=0,l=e.skips.length;a<l;a++)if(e.skips[a].test(o))return!1;for(a=0,l=e.names.length;a<l;a++)if(e.names[a].test(o))return!0;return!1}function u(o){return o instanceof Error?o.stack||o.message:o}})(L,L.exports);var ge=L.exports;(function(r,e){var n={};e=r.exports=ge,e.log=s,e.formatArgs=i,e.save=d,e.load=c,e.useColors=t,e.storage=typeof chrome<"u"&&typeof chrome.storage<"u"?chrome.storage.local:u(),e.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"];function t(){return typeof window<"u"&&window.process&&window.process.type==="renderer"?!0:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}e.formatters.j=function(o){try{return JSON.stringify(o)}catch(a){return"[UnexpectedJSONParseError]: "+a.message}};function i(o){var a=this.useColors;if(o[0]=(a?"%c":"")+this.namespace+(a?" %c":" ")+o[0]+(a?"%c ":" ")+"+"+e.humanize(this.diff),!!a){var l="color: "+this.color;o.splice(1,0,l,"color: inherit");var m=0,E=0;o[0].replace(/%[a-zA-Z%]/g,function(g){g!=="%%"&&(m++,g==="%c"&&(E=m))}),o.splice(E,0,l)}}function s(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function d(o){try{o==null?e.storage.removeItem("debug"):e.storage.debug=o}catch{}}function c(){var o;try{o=e.storage.debug}catch{}return!o&&typeof process<"u"&&"env"in process&&(o=n.DEBUG),o}e.enable(c());function u(){try{return window.localStorage}catch{}}})(D,D.exports);var me=D.exports;/*!
 * encodeurl
 * Copyright(c) 2016 Douglas Christopher Wilson
 * MIT Licensed
 */var pe=be,ve=/(?:[^\x21\x25\x26-\x3B\x3D\x3F-\x5B\x5D\x5F\x61-\x7A\x7E]|%(?:[^0-9A-Fa-f]|[0-9A-Fa-f][^0-9A-Fa-f]|$))+/g,ye=/(^|[^\uD800-\uDBFF])[\uDC00-\uDFFF]|[\uD800-\uDBFF]([^\uDC00-\uDFFF]|$)/g,_e="$1ï¿½$2";function be(r){return String(r).replace(ye,_e).replace(ve,encodeURI)}/*!
 * send
 * Copyright(c) 2012 TJ Holowaychuk
 * Copyright(c) 2014-2022 Douglas Christopher Wilson
 * MIT Licensed
 */var M=Q,h=me("send"),p=V("send"),Ce=ee,Ee=pe,q=te,xe=re,He=ne,S=T,k=ie,I=oe,we=ae,Fe=se,C=T,Re=de,z=T,Se=T,Ae=C.extname,X=C.join,N=C.normalize,$=C.resolve,R=C.sep,Te=/^ *bytes=/,j=60*60*24*365*1e3,U=/(?:^|[\\/])\.\.(?:[\\/]|$)/;B.exports=Me;B.exports.mime=k;function Me(r,e,n){return new f(r,e,n)}function f(r,e,n){z.call(this);var t=n||{};if(this.options=t,this.path=e,this.req=r,this._acceptRanges=t.acceptRanges!==void 0?!!t.acceptRanges:!0,this._cacheControl=t.cacheControl!==void 0?!!t.cacheControl:!0,this._etag=t.etag!==void 0?!!t.etag:!0,this._dotfiles=t.dotfiles!==void 0?t.dotfiles:"ignore",this._dotfiles!=="ignore"&&this._dotfiles!=="allow"&&this._dotfiles!=="deny")throw new TypeError('dotfiles option must be "allow", "deny", or "ignore"');this._hidden=!!t.hidden,t.hidden!==void 0&&p("hidden: use dotfiles: '"+(this._hidden?"allow":"ignore")+"' instead"),t.dotfiles===void 0&&(this._dotfiles=void 0),this._extensions=t.extensions!==void 0?O(t.extensions,"extensions option"):[],this._immutable=t.immutable!==void 0?!!t.immutable:!1,this._index=t.index!==void 0?O(t.index,"index option"):["index.html"],this._lastModified=t.lastModified!==void 0?!!t.lastModified:!0,this._maxage=t.maxAge||t.maxage,this._maxage=typeof this._maxage=="string"?I(this._maxage):Number(this._maxage),this._maxage=isNaN(this._maxage)?0:Math.min(Math.max(0,this._maxage),j),this._root=t.root?$(t.root):null,!this._root&&t.from&&this.from(t.from)}Se.inherits(f,z);f.prototype.etag=p.function(function(e){return this._etag=!!e,h("etag %s",this._etag),this},"send.etag: pass etag as option");f.prototype.hidden=p.function(function(e){return this._hidden=!!e,this._dotfiles=void 0,h("hidden %s",this._hidden),this},"send.hidden: use dotfiles option");f.prototype.index=p.function(function(e){var n=e?O(e,"paths argument"):[];return h("index %o",e),this._index=n,this},"send.index: pass index as option");f.prototype.root=function(e){return this._root=$(String(e)),h("root %s",this._root),this};f.prototype.from=p.function(f.prototype.root,"send.from: pass root as option");f.prototype.root=p.function(f.prototype.root,"send.root: pass root as option");f.prototype.maxage=p.function(function(e){return this._maxage=typeof e=="string"?I(e):Number(e),this._maxage=isNaN(this._maxage)?0:Math.min(Math.max(0,this._maxage),j),h("max-age %d",this._maxage),this},"send.maxage: pass maxAge as option");f.prototype.error=function(e,n){if(W(this,"error"))return this.emit("error",ke(e,n));var t=this.res,i=Re.message[e]||String(e),s=J("Error",q(i));Ne(t),n&&n.headers&&Ue(t,n.headers),t.statusCode=e,t.setHeader("Content-Type","text/html; charset=UTF-8"),t.setHeader("Content-Length",Buffer.byteLength(s)),t.setHeader("Content-Security-Policy","default-src 'none'"),t.setHeader("X-Content-Type-Options","nosniff"),t.end(s)};f.prototype.hasTrailingSlash=function(){return this.path[this.path.length-1]==="/"};f.prototype.isConditionalGET=function(){return this.req.headers["if-match"]||this.req.headers["if-unmodified-since"]||this.req.headers["if-none-match"]||this.req.headers["if-modified-since"]};f.prototype.isPreconditionFailure=function(){var e=this.req,n=this.res,t=e.headers["if-match"];if(t){var i=n.getHeader("ETag");return!i||t!=="*"&&Pe(t).every(function(c){return c!==i&&c!=="W/"+i&&"W/"+c!==i})}var s=A(e.headers["if-unmodified-since"]);if(!isNaN(s)){var d=A(n.getHeader("Last-Modified"));return isNaN(d)||d>s}return!1};f.prototype.removeContentHeaderFields=function(){var e=this.res;e.removeHeader("Content-Encoding"),e.removeHeader("Content-Language"),e.removeHeader("Content-Length"),e.removeHeader("Content-Range"),e.removeHeader("Content-Type")};f.prototype.notModified=function(){var e=this.res;h("not modified"),this.removeContentHeaderFields(),e.statusCode=304,e.end()};f.prototype.headersAlreadySent=function(){var e=new Error("Can't set headers after they are sent.");h("headers already sent"),this.error(500,e)};f.prototype.isCachable=function(){var e=this.res.statusCode;return e>=200&&e<300||e===304};f.prototype.onStatError=function(e){switch(e.code){case"ENAMETOOLONG":case"ENOENT":case"ENOTDIR":this.error(404,e);break;default:this.error(500,e);break}};f.prototype.isFresh=function(){return He(this.req.headers,{etag:this.res.getHeader("ETag"),"last-modified":this.res.getHeader("Last-Modified")})};f.prototype.isRangeFresh=function(){var e=this.req.headers["if-range"];if(!e)return!0;if(e.indexOf('"')!==-1){var n=this.res.getHeader("ETag");return!!(n&&e.indexOf(n)!==-1)}var t=this.res.getHeader("Last-Modified");return A(t)<=A(e)};f.prototype.redirect=function(e){var n=this.res;if(W(this,"directory")){this.emit("directory",n,e);return}if(this.hasTrailingSlash()){this.error(403);return}var t=Ee(De(this.path+"/")),i=J("Redirecting","Redirecting to "+q(t));n.statusCode=301,n.setHeader("Content-Type","text/html; charset=UTF-8"),n.setHeader("Content-Length",Buffer.byteLength(i)),n.setHeader("Content-Security-Policy","default-src 'none'"),n.setHeader("X-Content-Type-Options","nosniff"),n.setHeader("Location",t),n.end(i)};f.prototype.pipe=function(e){var n=this._root;this.res=e;var t=Oe(this.path);if(t===-1)return this.error(400),e;if(~t.indexOf("\0"))return this.error(400),e;var i;if(n!==null){if(t&&(t=N("."+R+t)),U.test(t))return h('malicious path "%s"',t),this.error(403),e;i=t.split(R),t=N(X(n,t))}else{if(U.test(t))return h('malicious path "%s"',t),this.error(403),e;i=N(t).split(R),t=$(t)}if(Le(i)){var s=this._dotfiles;switch(s===void 0&&(s=i[i.length-1][0]==="."?this._hidden?"allow":"ignore":"allow"),h('%s dotfile "%s"',s,t),s){case"allow":break;case"deny":return this.error(403),e;case"ignore":default:return this.error(404),e}}return this._index.length&&this.hasTrailingSlash()?(this.sendIndex(t),e):(this.sendFile(t),e)};f.prototype.send=function(e,n){var t=n.size,i=this.options,s={},d=this.res,c=this.req,u=c.headers.range,o=i.start||0;if($e(d)){this.headersAlreadySent();return}if(h('pipe "%s"',e),this.setHeader(e,n),this.type(e),this.isConditionalGET()){if(this.isPreconditionFailure()){this.error(412);return}if(this.isCachable()&&this.isFresh()){this.notModified();return}}if(t=Math.max(0,t-o),i.end!==void 0){var a=i.end-o+1;t>a&&(t=a)}if(this._acceptRanges&&Te.test(u)){if(u=Fe(t,u,{combine:!0}),this.isRangeFresh()||(h("range stale"),u=-2),u===-1)return h("range unsatisfiable"),d.setHeader("Content-Range",G("bytes",t)),this.error(416,{headers:{"Content-Range":d.getHeader("Content-Range")}});u!==-2&&u.length===1&&(h("range %j",u),d.statusCode=206,d.setHeader("Content-Range",G("bytes",t,u[0])),o+=u[0].start,t=u[0].end-u[0].start+1)}for(var l in i)s[l]=i[l];if(s.start=o,s.end=Math.max(o,o+t-1),d.setHeader("Content-Length",t),c.method==="HEAD"){d.end();return}this.stream(e,s)};f.prototype.sendFile=function(e){var n=0,t=this;h('stat "%s"',e),S.stat(e,function(d,c){if(d&&d.code==="ENOENT"&&!Ae(e)&&e[e.length-1]!==R)return i(d);if(d)return t.onStatError(d);if(c.isDirectory())return t.redirect(e);t.emit("file",e,c),t.send(e,c)});function i(s){if(t._extensions.length<=n)return s?t.onStatError(s):t.error(404);var d=e+"."+t._extensions[n++];h('stat "%s"',d),S.stat(d,function(c,u){if(c)return i(c);if(u.isDirectory())return i();t.emit("file",d,u),t.send(d,u)})}};f.prototype.sendIndex=function(e){var n=-1,t=this;function i(s){if(++n>=t._index.length)return s?t.onStatError(s):t.error(404);var d=X(e,t._index[n]);h('stat "%s"',d),S.stat(d,function(c,u){if(c)return i(c);if(u.isDirectory())return i();t.emit("file",d,u),t.send(d,u)})}i()};f.prototype.stream=function(e,n){var t=this,i=this.res,s=S.createReadStream(e,n);this.emit("stream",s),s.pipe(i);function d(){Ce(s,!0)}we(i,d),s.on("error",function(u){d(),t.onStatError(u)}),s.on("end",function(){t.emit("end")})};f.prototype.type=function(e){var n=this.res;if(!n.getHeader("Content-Type")){var t=k.lookup(e);if(!t){h("no content-type");return}var i=k.charsets.lookup(t);h("content-type %s",t),n.setHeader("Content-Type",t+(i?"; charset="+i:""))}};f.prototype.setHeader=function(e,n){var t=this.res;if(this.emit("headers",t,e,n),this._acceptRanges&&!t.getHeader("Accept-Ranges")&&(h("accept ranges"),t.setHeader("Accept-Ranges","bytes")),this._cacheControl&&!t.getHeader("Cache-Control")){var i="public, max-age="+Math.floor(this._maxage/1e3);this._immutable&&(i+=", immutable"),h("cache-control %s",i),t.setHeader("Cache-Control",i)}if(this._lastModified&&!t.getHeader("Last-Modified")){var s=n.mtime.toUTCString();h("modified %s",s),t.setHeader("Last-Modified",s)}if(this._etag&&!t.getHeader("ETag")){var d=xe(n);h("etag %s",d),t.setHeader("ETag",d)}};function Ne(r){for(var e=Be(r),n=0;n<e.length;n++)r.removeHeader(e[n])}function De(r){for(var e=0;e<r.length&&r[e]==="/";e++);return e>1?"/"+r.substr(e):r}function Le(r){for(var e=0;e<r.length;e++){var n=r[e];if(n.length>1&&n[0]===".")return!0}return!1}function G(r,e,n){return r+" "+(n?n.start+"-"+n.end:"*")+"/"+e}function J(r,e){return`<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>`+r+`</title>
</head>
<body>
<pre>`+e+`</pre>
</body>
</html>
`}function ke(r,e){return e?e instanceof Error?M(r,e,{expose:!1}):M(r,e):M(r)}function Oe(r){try{return decodeURIComponent(r)}catch{return-1}}function Be(r){return typeof r.getHeaderNames!="function"?Object.keys(r._headers||{}):r.getHeaderNames()}function W(r,e){var n=typeof r.listenerCount!="function"?r.listeners(e).length:r.listenerCount(e);return n>0}function $e(r){return typeof r.headersSent!="boolean"?!!r._header:r.headersSent}function O(r,e){for(var n=[].concat(r||[]),t=0;t<n.length;t++)if(typeof n[t]!="string")throw new TypeError(e+" must be array of strings or false");return n}function A(r){var e=r&&Date.parse(r);return typeof e=="number"?e:NaN}function Pe(r){for(var e=0,n=[],t=0,i=0,s=r.length;i<s;i++)switch(r.charCodeAt(i)){case 32:t===e&&(t=e=i+1);break;case 44:t!==e&&n.push(r.substring(t,e)),t=e=i+1;break;default:e=i+1;break}return t!==e&&n.push(r.substring(t,e)),n}function Ue(r,e){for(var n=Object.keys(e),t=0;t<n.length;t++){var i=n[t];r.setHeader(i,e[i])}}var Ve=B.exports;export{Ve as s};
